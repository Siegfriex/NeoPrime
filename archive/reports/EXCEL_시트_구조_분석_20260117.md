# 엑셀 시트 구조 분석 보고서

**분석일**: 2026-01-17  
**파일**: 202511고속성장분석기(가채점)20251114 (1).xlsx

---

## 📋 시트별 구조 분석

### 1. RAWSCORE 시트

**컬럼 구조**:
```
[0] 영역: 국어, 수학, 영어, 탐구1, 탐구2 등
[1] 과목명: 국어(언매), 수학(미적), 물리학I 등
[2] 원점수: 총 원점수 (100, 99, 98, ...)
[3] Unnamed: 3: "공통" (헤더)
[4] Unnamed: 4: "선택" (헤더)
[5] 과목명-원점수: 복합 키 (예: "국어(언매)-76-24")
[6] 202511(가채점): 표준점수 (146, 145, ...)
[7] Unnamed: 7: 백분위 (100.0, 99.8, ...)
[8] Unnamed: 8: 등급 (1.0, 2.0, ...)
[9] Unnamed: 9: 누적% (0.079276, ...)
```

**샘플 데이터**:
```
영역    과목명       원점수  과목명-원점수          202511  백분위  등급   누적%
국어  국어(언매)    100    국어(언매)-76-24       146    100.0   1.0   0.079
국어  국어(언매)     99    국어(언매)-76-23       145    100.0   1.0   0.079
```

**핵심 발견**:
- ✅ 복합 키: "과목명-원점수" 컬럼 활용 가능
- ⚠️ 컬럼명이 "Unnamed"로 되어 있음 (헤더 행 처리 필요)
- ✅ 202511(가채점) = 표준점수
- ✅ Unnamed: 7 = 백분위
- ✅ Unnamed: 8 = 등급
- ✅ Unnamed: 9 = 누적%

---

### 2. INDEX 시트

**컬럼 구조**:
```
[0] INDEX: 인코딩된 키 (예: "510gs0t20509")
[1-N] Unnamed: 1~N: 데이터 컬럼들
```

**샘플 데이터**:
```
INDEX             Unnamed: 1  Unnamed: 2  ...
510gs0t20509      NaN         1           ...
510h00c60509      NaN         1           ...
```

**핵심 발견**:
- ⚠️ INDEX 컬럼이 해시 키로 인코딩되어 있음
- ⚠️ 점수 조합 (korean_std, math_std, ...) 컬럼이 없음
- 💡 INDEX 값 디코딩 필요 또는 다른 방식으로 조회

**추정**:
- `510gs0t20509` 같은 값은 점수 조합을 인코딩한 것
- 실제 매핑 방법 확인 필요 (엑셀 수식 분석)

---

### 3. PERCENTAGE 시트

**컬럼 구조**:
```
[0] Unnamed: 0: "%" (백분위)
[1] Unnamed: 1: "★백분위합 이과"
[2] Unnamed: 2: "★표점합 이과"
[3] Unnamed: 3: "가천의학 이과"
[4] Unnamed: 4: "가천통합백 이과"
[5] Unnamed: 5: "가천통합표 이과"
[6] Unnamed: 6: "가천한의 이과"
...
```

**샘플 데이터**:
```
%      ★백분위합 이과  ★표점합 이과  가천의학 이과  가천통합백 이과  ...
0.0    300         432        99.6        99.6        ...
0.01   300         432        99.6        99.6        ...
```

**핵심 발견**:
- ✅ 첫 컬럼 = 백분위 (%)
- ✅ 대학별 컬럼 패턴: "{대학명}{전공} {계열}"
  - 예: "가천의학 이과", "서울대자연 이과"
- ⚠️ 컬럼명이 "Unnamed"로 되어 있음 (header=1, skiprows=[0] 필요)

---

### 4. RESTRICT 시트

**컬럼 구조**:
```
[0] □ 결격사유<수학,탐구>
[1] Unnamed: 1
[2] Unnamed: 2: "점수환산"
[3] Unnamed: 3: "수학,탐구 미응시/중복"
[4] □ 결격사유<영어,한국사,제2외국어>
[5] Unnamed: 5
[6] Unnamed: 6: "점수환산"
[7] Unnamed: 7: "영어,한국사,제2외국어"
...
```

**샘플 데이터**:
```
□ 결격사유<수학,탐구>  Unnamed: 1  ...
응시제한 모집단위       점수환산    ...
NaN                   고신의학    ...
NaN                   서울자연    ...
```

**핵심 발견**:
- ⚠️ "결격사유" 컬럼이 없음 (카테고리별로 분산)
- ✅ 카테고리: 수학/탐구, 영어/한국사/제2외국어, 과학탐구과목
- ✅ 모집단위별 제한 조건 나열

---

## 🔧 매핑 개선 방안

### 1. RAWSCORE 개선

**현재 문제**:
- 컬럼명이 "Unnamed"로 되어 있어 직접 접근 어려움

**해결 방안**:
```python
# 인덱스로 접근
standard_score = row.iloc[6]  # 202511(가채점)
percentile = row.iloc[7]       # Unnamed: 7
grade = row.iloc[8]            # Unnamed: 8
cumulative_pct = row.iloc[9]   # Unnamed: 9

# 또는 복합 키 활용
composite_key = row["과목명-원점수"]  # "국어(언매)-76-24"
```

### 2. INDEX 개선

**현재 문제**:
- INDEX 값이 해시화되어 있어 직접 점수 조합으로 조회 불가

**해결 방안**:
1. INDEX 인코딩 방식 역공학
2. 또는 다른 시트 (SUBJECT1/2/3)에서 점수 조합 매핑 확인
3. 또는 INDEX를 사용하지 않고 RAWSCORE + PERCENTAGE로 직접 계산

### 3. PERCENTAGE 개선

**현재 문제**:
- 컬럼명이 "Unnamed"로 되어 있음
- 실제 헤더가 첫 행에 있음

**해결 방안**:
```python
# header=0으로 변경하여 첫 행을 헤더로 사용
df = pd.read_excel(xlsx, "PERCENTAGE", header=0)

# 대학-전공-계열 파싱
# "가천의학 이과" → university="가천", major="의학", track="이과"
pattern = r"^(.+?)([가-힣]+)\s+(이과|문과)$"
```

### 4. RESTRICT 개선

**현재 문제**:
- "결격사유" 단일 컬럼이 아니라 카테고리별 분산

**해결 방안**:
```python
# 카테고리별로 처리
math_restrict_col = "□ 결격사유<수학,탐구>"
eng_restrict_col = "□ 결격사유<영어,한국사,제2외국어>"
science_restrict_col = "□ 결격사유<과학탐구과목>"
```

---

## 📊 작업 우선순위

| 우선순위 | 작업 | 난이도 | 예상 시간 |
|---------|------|--------|----------|
| **P0** | RAWSCORE 컬럼 인덱스 매핑 | 낮음 | 30분 |
| **P0** | PERCENTAGE header 수정 | 낮음 | 30분 |
| **P1** | INDEX 인코딩 해독 | 높음 | 2-3시간 |
| **P1** | RESTRICT 카테고리 처리 | 중간 | 1-2시간 |
| **P2** | 커트라인 자동 계산 | 중간 | 1-2시간 |

---

## 🎯 다음 액션

1. **즉시 적용 가능**:
   - RAWSCORE: iloc 인덱스로 접근
   - PERCENTAGE: header=0 변경

2. **추가 분석 필요**:
   - INDEX 인코딩 방식 확인
   - SUBJECT1/2/3 시트에서 점수 매핑 확인

3. **대안 전략**:
   - INDEX를 우회하고 RAWSCORE + PERCENTAGE로 직접 계산

---

**분석자**: Theory Engine 개발팀  
**분석 일시**: 2026-01-17
